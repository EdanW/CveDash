<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CVE Dashboard - DDoS Vulnerabilities</title>
    <link rel="stylesheet" href="/styles.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-controls">
                <div class="metric-toggle" aria-label="Select metric version">
                    <label for="metricVersionSelect" class="metric-toggle__label">Metric:</label>
                    <select id="metricVersionSelect" class="metric-toggle__select">
                        <option value="latest" selected>Latest</option>
                        <option value="v2">CVSS v2</option>
                        <option value="v3.0">CVSS v3.0</option>
                        <option value="v3.1">CVSS v3.1</option>
                        <option value="v4.0">CVSS v4.0</option>
                    </select>
                </div>
                <div class="status-toggle" aria-label="Select vulnerability status filter">
                    <label for="statusFilterSelect" class="status-toggle__label">Status:</label>
                    <select id="statusFilterSelect" class="status-toggle__select">
                        <option value="accepted" selected>Only Accepted</option>
                        <option value="open-accepted">Open & Accepted</option>
                        <option value="all">All (Including Rejected)</option>
                    </select>
                </div>
            </div>
            <h1>üõ°Ô∏è CVE Dashboard</h1>
            <p>Monitor and manage DDoS-related vulnerabilities</p>
        </div>
        
        <div class="content">
            <div class="stats">
                <div class="stat-card">
                    <h3 id="totalCVEs">0%</h3>
                    <p id="totalCVEsLabel">DDoS vs Other CVEs</p>
                </div>
            </div>
            
            <div class="controls">
                <div class="search-container">
                    <input type="text" id="cveSearchInput" placeholder="Search CVE ID (e.g., 2009-0041)" class="search-input">
                    <button class="btn btn-primary" onclick="searchCVE()">üîç Search</button>
                </div>
                <button class="btn btn-success" onclick="refreshData()">üîÑ Refresh</button>
                <button class="btn btn-warning" onclick="filterDDoSOnly()">üõ°Ô∏è DDoS Only</button>
            </div>

            <div class="charts-row">
                <div class="card search-results-widget" id="searchResultsWidget">
                    <h3 class="widget-title">üîç Search Results</h3>
                    <div id="searchResultsContent">
                        <div class="search-placeholder">
                            <p>üîç Look for a CVE</p>
                        </div>
                    </div>
                </div>

                <div class="card severity-widget">
                    <h3 class="widget-title">üìä Severity Distribution</h3>
                    <div class="widget-canvas-wrap">
                        <canvas id="severityChart"></canvas>
                    </div>
                </div>

                <div class="card cwe-widget">
                    <h3 class="widget-title">üîß Top 5 CWEs</h3>
                    <div id="cweListContent">
                        <div class="cwe-placeholder">
                            <p>üìã CWE data loading...</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card yearly-trends-widget">
                <h3 class="widget-title">üìà CVE Trends by Year</h3>
                <div class="widget-canvas-wrap">
                    <canvas id="yearlyTrendsChart"></canvas>
                </div>
            </div>

            <div class="card cvss-distribution-widget">
                <h3 class="widget-title">üìä CVSS Score Distribution</h3>
                <div class="cvss-distribution-controls">
                    <label class="cvss-toggle">
                        <input type="checkbox" id="cvssShowAllToggle" checked>
                        <span class="cvss-toggle-text">Show All CVEs (uncheck for DDoS only)</span>
                    </label>
                </div>
                <div class="widget-canvas-wrap">
                    <canvas id="cvssDistributionChart"></canvas>
                </div>
                <div class="cvss-stats-summary">
                    <div class="cvss-stat">
                        <span class="cvss-stat-label">Total:</span>
                        <span id="cvssStatTotal">0</span>
                    </div>
                    <div class="cvss-stat">
                        <span class="cvss-stat-label">Average:</span>
                        <span id="cvssStatAverage">0.0</span>
                    </div>
                </div>
            </div>

            <div class="card cvss-boxplot-widget">
                <h3 class="widget-title">üìä CVSS Score Box Plot by Metric Version</h3>
                <div class="cvss-boxplot-controls">
                    <label class="cvss-boxplot-toggle">
                        <input type="checkbox" id="cvssBoxplotDdosToggle">
                        <span class="cvss-boxplot-toggle-text">DDoS Only (uncheck for all CVEs)</span>
                    </label>
                </div>
                <div class="widget-canvas-wrap">
                    <canvas id="cvssBoxplotChart"></canvas>
                </div>
                <div class="cvss-boxplot-stats">
                    <div class="boxplot-legend">
                        <div class="legend-item">
                            <span class="legend-color" style="background-color: #ff6384;"></span>
                            <span>CVSS v2.0</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-color" style="background-color: #36a2eb;"></span>
                            <span>CVSS v3.0</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-color" style="background-color: #4bc0c0;"></span>
                            <span>CVSS v3.1</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-color" style="background-color: #9966ff;"></span>
                            <span>CVSS v4.0</span>
                        </div>
                    </div>
                    <div style="font-size: 12px; color: #666; margin-top: 12px;">
                        <h4 style="margin: 0 0 8px 0; color: #333; font-size: 13px;">üìñ How to Read This Box Plot:</h4>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; text-align: left;">
                            <div><strong>üî¥ Red Dot:</strong> Mean (average) CVSS score</div>
                            <div><strong>üì¶ Box:</strong> Middle 50% of scores (Q1 to Q3)</div>
                            <div><strong>‚ûñ Line in Box:</strong> Median (middle value)</div>
                            <div><strong>üìè Whiskers:</strong> Min/Max normal range</div>
                            <div><strong>‚ö´ Outliers:</strong> Unusually high/low scores</div>
                            <div><strong>üí° Hover:</strong> See detailed statistics</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="filters-section">
                <div class="filter-container">
                    <label for="yearFilter" class="filter-label">Filter by Year:</label>
                    <select id="yearFilter" class="filter-select">
                        <option value="all">All Years</option>
                        <option value="2025">2025</option>
                        <option value="2024">2024</option>
                        <option value="2023">2023</option>
                        <option value="2022">2022</option>
                        <option value="2021">2021</option>
                        <option value="2020">2020</option>
                        <option value="2019">2019</option>
                        <option value="2018">2018</option>
                        <option value="2017">2017</option>
                        <option value="2016">2016</option>
                        <option value="2015">2015</option>
                        <option value="2014">2014</option>
                        <option value="2013">2013</option>
                        <option value="2012">2012</option>
                        <option value="2011">2011</option>
                        <option value="2010">2010</option>
                        <option value="2009">2009</option>
                        <option value="2008">2008</option>
                        <option value="2007">2007</option>
                        <option value="2006">2006</option>
                        <option value="2005">2005</option>
                        <option value="2004">2004</option>
                        <option value="2003">2003</option>
                        <option value="2002">2002</option>
                        <option value="2001">2001</option>
                        <option value="2000">2000</option>
                        <option value="1999">1999</option>
                        <option value="1998">1998</option>
                    </select>
                </div>
                <div class="filter-container">
                    <label for="severityFilter" class="filter-label">Min CVSS Score:</label>
                    <select id="severityFilter" class="filter-select">
                        <option value="0">All Scores (0.0+)</option>
                        <option value="0.5">0.5+</option>
                        <option value="1.0">1.0+</option>
                        <option value="1.5">1.5+</option>
                        <option value="2.0">2.0+</option>
                        <option value="2.5">2.5+</option>
                        <option value="3.0">3.0+</option>
                        <option value="3.5">3.5+</option>
                        <option value="4.0">4.0+</option>
                        <option value="4.5">4.5+</option>
                        <option value="5.0">5.0+</option>
                        <option value="5.5">5.5+</option>
                        <option value="6.0">6.0+</option>
                        <option value="6.5">6.5+</option>
                        <option value="7.0">7.0+</option>
                        <option value="7.5">7.5+</option>
                        <option value="8.0">8.0+</option>
                        <option value="8.5">8.5+</option>
                        <option value="9.0">9.0+</option>
                        <option value="9.5">9.5+</option>
                        <option value="10.0">10.0 (Critical)</option>
                    </select>
                </div>
                <div class="filter-container">
                    <label for="severityLevelFilter" class="filter-label">Severity Level:</label>
                    <div class="severity-checkboxes">
                        <label class="severity-checkbox">
                            <input type="checkbox" value="CRITICAL" checked>
                            <span class="severity-critical">Critical</span>
                        </label>
                        <label class="severity-checkbox">
                            <input type="checkbox" value="HIGH" checked>
                            <span class="severity-high">High</span>
                        </label>
                        <label class="severity-checkbox">
                            <input type="checkbox" value="MEDIUM" checked>
                            <span class="severity-medium">Medium</span>
                        </label>
                        <label class="severity-checkbox">
                            <input type="checkbox" value="LOW" checked>
                            <span class="severity-low">Low</span>
                        </label>
                        <label class="severity-checkbox">
                            <input type="checkbox" value="UNKNOWN" checked>
                            <span class="severity-unknown">Unknown</span>
                        </label>
                    </div>
                </div>
            </div>
            
            <div id="cvesContainer" class="cves-grid">
                <!-- CVEs will be loaded here -->
            </div>
        </div>
    </div>
    
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@sgratzl/chartjs-chart-boxplot"></script>
    <script src="/script.js"></script>
</body>
</html> 